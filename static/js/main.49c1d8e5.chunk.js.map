{"version":3,"sources":["components/VideoListItems.js","containers/VideoList.js","components/SearchBar.js","components/Video.js","components/VideoDetails.js","containers/App.js","index.js"],"names":["VideoListItem","props","movie","src","poster_path","alt","width","height","title","vote_average","className","onClick","event","preventDefault","callback","VideoList","movieList","map","index","key","id","receiveCallBack","SearchBar","handleChange","setState","searchText","target","value","state","lockRequest","setTimeout","search","interval","handleOnClick","placeholder","type","onChange","this","class","Component","Video","videoId","VideoDetails","date","Date","release_date","toLocaleDateString","year","month","day","original_title","overview","original_language","API_END_POINT","API_KEY","App","onClickSearch","axios","get","then","response","console","log","data","results","currentMovie","applyVideoToCurrentMovie","setRecommendation","genre_ids","length","paragrapheError","document","querySelector","style","color","innerHTML","catch","error","movies","initMovies","a","async","result","slice","videos","youtubeKey","newCurrentMovieState","resultRecommendation","href","onClickListItem","bind","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.49c1d8e5.chunk.js","sourcesContent":["import React from \"react\";\n\nconst BASE_URL_IMDB = \"https://image.tmdb.org/t/p/w500\";\n\nconst VideoListItem = (props) => {\n\n    const { movie } = props;\n    return (\n        <>\n            <tr>\n                <td>\n                    <img \n                        src={ `${BASE_URL_IMDB}${movie.poster_path}`}\n                        alt=\"cover film\"\n                        width=\"75\"\n                        height=\"100\"\n                    />\n                </td>\n                <td>{ movie.title }</td>\n                <td>{ movie.vote_average }</td>\n                <td>\n                    <button \n                        className=\"btn btn-small btn-outline-info\"\n                        onClick= { handleOnClick }\n                    >Voir ce film</button></td>\n            </tr>\n        </>\n    )\n    function handleOnClick(event) {\n        event.preventDefault();\n        props.callback(movie)\n    };\n\n\n}\n\nexport default VideoListItem;","import React from \"react\"\nimport VideoListItem from \"../components/VideoListItems\";\n\nconst VideoList = (props) => {\n\n    const {movieList} = props;\n    return (\n        <table className=\"table-striped table-bordered table-hover table-sm\">\n            <caption>Les 10 derniers films populaire</caption>\n            <thead className=\"thead-dark\">\n                <tr>\n                    <th>Cover</th>\n                    <th>Titre en Français</th>\n                    <th>Note</th>\n                    <th>Actions</th>\n                </tr>\n            </thead>\n            <tbody>\n                {\n                    movieList.map( (movie, index) => {\n                        return <VideoListItem \n                            key = { movie.id } \n                            movie = { movie }\n                            index = { index }\n                            callback = { receiveCallBack }\n                        />\n                    })\n                }\n            </tbody>\n        </table>\n    )\n\n    function receiveCallBack(movie) {\n        props.callback(movie);\n    }\n}\n\nexport default VideoList;","import React, { Component } from \"react\";\n\nclass SearchBar extends Component {\n\n    constructor(props) {\n        super(props); \n        this.state = {\n            searchText: \"\",\n            placeholder: \"Tapez le nom d'un film dans la langue que vous voulez...\",\n            lockRequest: false,\n            interval: 1000\n        }\n    }\n\n    render() {\n        return (\n            <>\n                <input\n                    className = \"form-control\"\n                    type=\"text\"\n                    onChange = { this.handleChange }\n                    placeholder = { this.state.placeholder }\n                />\n                <div class=\"input-group-prepend\">\n                    <button \n                        className = \"btn btn-secondary\"\n                        onClick = { this.handleOnClick }\n                    >Recherchez</button>\n                </div>\n            </>\n        )\n    }\n\n    handleChange = (event) => {\n        this.setState({\n            searchText: event.target.value\n        });\n        if ( !this.state.lockRequest) {\n            this.setState({ lockRequest: true });\n\n            setTimeout(() => {\n                this.search()\n            }, this.state.interval);\n        }\n    }\n\n    handleOnClick = () => {\n        this.search();\n    }\n    \n    search() {\n        this.props.callback(this.state.searchText);\n        this.setState({\n            lockRequest: false\n        })      \n    }\n}\n\nexport default SearchBar;","import React from \"react\";\n\nconst BASE_URL_YOUTUBE = \"https://www.youtube.com/embed/\";\n\nconst Video = ({videoId}) => {\n    return (\n        <>\n            <iframe className=\"embed-responsive-item\"\n                title=\"Video Youtube\"\n                src={`${BASE_URL_YOUTUBE}${videoId}`}\n            />\n        </>\n    )\n}\n\nexport default Video;","import React, {Fragment} from \"react\";\n\nconst BASE_URL_IMDB = \"https://image.tmdb.org/t/p/w500\";\n\nconst VideoDetails = ({movie}) => {\n    const date = new Date(movie.release_date).toLocaleDateString(\"fr-FR\", {\n        year: \"numeric\",\n        month: \"long\",\n        day: \"2-digit\"\n    })\n    return (\n        <Fragment>\n            <div className=\"videoDetails_cover\">\n                <img \n                    src = {`${BASE_URL_IMDB}${movie.poster_path}`}\n                    alt = {`Affiche du film : ${movie.original_title}`}\n                    width = \"250\"\n                />\n            </div>\n            <div className=\"videoDetails_cover\">\n                <h2 className=\"text-center\">{ movie.title } <small className=\"text-secondary\">- { movie.id }</small></h2>\n                <hr />\n                <p className=\"lead\">{ movie.overview }</p>\n                <ul className=\"list-group\">\n                    <li className=\"list-group-item\">Titre original : { movie.original_title }</li>\n                    <li className=\"list-group-item\">Langue original : { movie.original_language }</li>\n                    <li className=\"list-group-item\">Date de sortie : { date }</li>\n                </ul>\n            </div>\n        </Fragment>\n    )\n}\n\nexport default VideoDetails;","import React, { Component } from 'react';\nimport './App.scss';\n\n// Container\nimport VideoList    from './VideoList';\n\n// Components\nimport SearchBar    from \"../components/SearchBar\";\nimport Video        from '../components/Video';\nimport VideoDetails from \"../components/VideoDetails\";\n\n// Librairies\nimport axios        from \"axios\"\n\n// Constantes The Movie Database\nconst API_END_POINT       = \"https://api.themoviedb.org/3/\";\nconst API_KEY             = \"api_key=e3848ee01e33080bf2aeb19aef66d5db\";\nconst URL_POPULAR_MOVIES  = \"discover/movie?language=fr&sort_by=popularity.desc&include_adult=false&append_to_response=images\";\nconst URL_SEARCH          = \"search/movie?language=fr&include_adult=false\";\n\n\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { \n      movies: {}, \n      currentMovie: {}\n    }\n  }\n\n  // Avant le render\n  UNSAFE_componentWillMount() {\n    this.initMovies();\n  }\n\n\n\n  initMovies() {\n    axios\n    .get(`${API_END_POINT}${URL_POPULAR_MOVIES}&${API_KEY}`)\n    .then(async response => {\n      \n      const result = await response.data.results;\n      /*\n        console.groupCollapsed(\"résultat de ma constante : result\");\n          console.table(result);\n        console.groupEnd();\n      */\n\n      this.setState({ \n\n        movies: result.slice(1,10),\n        currentMovie: result[0]\n      }, () => {\n        // Appel d'une fonction de callback pour récupérer la vidéo\n        this.applyVideoToCurrentMovie()\n      });\n\n      /* \n        console.groupCollapsed(\"voir le résultat du .slice(1,6)\")\n          console.table(result.slice(1,6))\n        console.groupEnd();\n\n        console.groupCollapsed(\"voir l'élément 0 de ma liste de film récupéré\")\n          console.table(result[0])\n        console.groupEnd()\n      */\n    })\n    .catch(error => {\n      console.error(error);\n    })\n  }\n\n  applyVideoToCurrentMovie() {\n    axios\n      .get(`${API_END_POINT}movie/${ this.state.currentMovie.id }?${API_KEY}&append_to_response=videos&include_adult=false`)\n      .then( async response => {\n\n        // récupération de la référence de la video (key)\n        const youtubeKey = await response.data.videos.results[0].key;\n\n        // Conception d'un nouveau tableau\n        let newCurrentMovieState = this.state.currentMovie;\n\n        // Ajout de la référence de la vidéo dans le nouveau tableau \n        newCurrentMovieState.videoId = youtubeKey;\n\n        // Remplacement du state principal\n        this.setState({\n          currentMovie: newCurrentMovieState\n        })\n      })\n      .catch(error => {\n        console.error(error)\n      })\n  }\n  \n  onClickListItem(movie) {\n    this.setState( {currentMovie: movie}, function() {\n      this.applyVideoToCurrentMovie();\n      this.setRecommendation();\n    } )\n  }\n\n  onClickSearch = (searchText) => {\n\n    if ( searchText ) {\n      axios\n        .get(`${API_END_POINT}${ URL_SEARCH }&${API_KEY}&query=${searchText}`)\n        .then( response => {\n          console.log(response)\n          \n          if ( response.data && response.data.results[0] ) {\n\n            if ( response.data.results[0].id !== this.state.currentMovie.id ) {\n              \n              this.setState({ currentMovie: response.data.results[0] }, () => {\n                this.applyVideoToCurrentMovie();\n                this.setRecommendation();\n              })\n            }\n          }\n\n          if ( response.data.results[0].genre_ids.length === 0 ) {\n\n            const paragrapheError = document.querySelector('#error');\n            paragrapheError.style.color = \"salmon\";\n\n            \n            setTimeout(() => {\n              paragrapheError.innerHTML = `Hum... Chargement trop long, <strong>redirection automatique</strong> vers un film similaire. <strong>Veuillez patienter</strong>...`;\n            }, 3000, setTimeout(() => {              \n              this.setState({currentMovie: response.data.results[1]}, () => {\n                this.applyVideoToCurrentMovie();\n                this.setRecommendation();\n              });\n              paragrapheError.innerHTML = \"\";\n            }, 8000));\n          }\n        })\n        .catch(error => {\n          console.error(error);\n        })\n    }\n    \n  }\n\n  /*\n    ${API_END_POINT}movie/${this.state.currentMovie.id}/recommendations?${API_KEY}&language=fr\n  */\n\n  setRecommendation() {\n    axios\n      .get(`${API_END_POINT}movie/${this.state.currentMovie.id}/recommendations?${API_KEY}&language=fr`)\n      .then(async response => {\n        const resultRecommendation = await response.data.results;  \n        this.setState({ movies: resultRecommendation.slice(0,9) });\n      })\n  }\n\n  render() {\n\n    return (      \n      <>\n        <nav className=\"navbar navbar-expand-lg navbar-dark bg-dark\">\n          <a href=\"/\" className=\"navbar-brand\">Allo ReactMovie</a>\n          <span className=\"navbar-text ml-auto\">SPA codé avec passion</span>\n        </nav>\n\n        <div className=\"container mt-5\">\n          <div className=\"input-group\">\n            <SearchBar callback = { this.onClickSearch } />\n          </div>\n          <p id=\"error\" className=\"mt-3\"></p>\n        </div>\n\n        <section className=\"container-fluid\">\n          <article className=\"container_article\">\n            <div className=\"container_videoDetails\">\n              <VideoDetails movie = { this.state.currentMovie } />\n            </div>\n            <div className=\"embed-responsive embed-responsive-16by9\">\n              <Video videoId = { this.state.currentMovie.videoId } />\n            </div>\n          </article>\n\n          <aside className=\"container_aside\">\n              { this.state.movies.length >= 5 ? (\n                <VideoList \n                  movieList = { this.state.movies }\n                  callback = { this.onClickListItem.bind(this) }\n                />\n              ) : (\n                <img src=\"https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif\" alt=\"loading gif\" width=\"80\" height=\"80\" />\n              ) }\n            </aside>\n        </section>\n      </>\n    )\n  }\n\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './containers/App';\n\n// const API_KEY = \"e3848ee01e33080bf2aeb19aef66d5db\";\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}