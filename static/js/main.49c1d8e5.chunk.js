(this["webpackJsonpsection-2"]=this["webpackJsonpsection-2"]||[]).push([[0],{19:function(e,t,a){e.exports=a(45)},24:function(e,t,a){},26:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(18),i=a.n(r),l=(a(24),a(2)),o=a.n(l),s=a(4),u=a(5),m=a(7),d=a(6),v=a(8),h=(a(26),function(e){var t=e.movie;return c.a.createElement(c.a.Fragment,null,c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("img",{src:"".concat("https://image.tmdb.org/t/p/w500").concat(t.poster_path),alt:"cover film",width:"75",height:"100"})),c.a.createElement("td",null,t.title),c.a.createElement("td",null,t.vote_average),c.a.createElement("td",null,c.a.createElement("button",{className:"btn btn-small btn-outline-info",onClick:function(a){a.preventDefault(),e.callback(t)}},"Voir ce film"))))}),p=function(e){var t=e.movieList;return c.a.createElement("table",{className:"table-striped table-bordered table-hover table-sm"},c.a.createElement("caption",null,"Les 10 derniers films populaire"),c.a.createElement("thead",{className:"thead-dark"},c.a.createElement("tr",null,c.a.createElement("th",null,"Cover"),c.a.createElement("th",null,"Titre en Fran\xe7ais"),c.a.createElement("th",null,"Note"),c.a.createElement("th",null,"Actions"))),c.a.createElement("tbody",null,t.map((function(e,t){return c.a.createElement(h,{key:e.id,movie:e,index:t,callback:a})}))));function a(t){e.callback(t)}},f=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){a.setState({searchText:e.target.value}),a.state.lockRequest||(a.setState({lockRequest:!0}),setTimeout((function(){a.search()}),a.state.interval))},a.handleOnClick=function(){a.search()},a.state={searchText:"",placeholder:"Tapez le nom d'un film dans la langue que vous voulez...",lockRequest:!1,interval:1e3},a}return Object(v.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{className:"form-control",type:"text",onChange:this.handleChange,placeholder:this.state.placeholder}),c.a.createElement("div",{class:"input-group-prepend"},c.a.createElement("button",{className:"btn btn-secondary",onClick:this.handleOnClick},"Recherchez")))}},{key:"search",value:function(){this.props.callback(this.state.searchText),this.setState({lockRequest:!1})}}]),t}(n.Component),g=function(e){var t=e.videoId;return c.a.createElement(c.a.Fragment,null,c.a.createElement("iframe",{className:"embed-responsive-item",title:"Video Youtube",src:"".concat("https://www.youtube.com/embed/").concat(t)}))},E=function(e){var t=e.movie,a=new Date(t.release_date).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"2-digit"});return c.a.createElement(n.Fragment,null,c.a.createElement("div",{className:"videoDetails_cover"},c.a.createElement("img",{src:"".concat("https://image.tmdb.org/t/p/w500").concat(t.poster_path),alt:"Affiche du film : ".concat(t.original_title),width:"250"})),c.a.createElement("div",{className:"videoDetails_cover"},c.a.createElement("h2",{className:"text-center"},t.title," ",c.a.createElement("small",{className:"text-secondary"},"- ",t.id)),c.a.createElement("hr",null),c.a.createElement("p",{className:"lead"},t.overview),c.a.createElement("ul",{className:"list-group"},c.a.createElement("li",{className:"list-group-item"},"Titre original : ",t.original_title),c.a.createElement("li",{className:"list-group-item"},"Langue original : ",t.original_language),c.a.createElement("li",{className:"list-group-item"},"Date de sortie : ",a))))},b=a(3),y=a.n(b),k="https://api.themoviedb.org/3/",N="api_key=e3848ee01e33080bf2aeb19aef66d5db",M=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).onClickSearch=function(e){e&&y.a.get("".concat(k).concat("search/movie?language=fr&include_adult=false","&").concat(N,"&query=").concat(e)).then((function(e){if(console.log(e),e.data&&e.data.results[0]&&e.data.results[0].id!==a.state.currentMovie.id&&a.setState({currentMovie:e.data.results[0]},(function(){a.applyVideoToCurrentMovie(),a.setRecommendation()})),0===e.data.results[0].genre_ids.length){var t=document.querySelector("#error");t.style.color="salmon",setTimeout((function(){t.innerHTML="Hum... Chargement trop long, <strong>redirection automatique</strong> vers un film similaire. <strong>Veuillez patienter</strong>..."}),3e3,setTimeout((function(){a.setState({currentMovie:e.data.results[1]},(function(){a.applyVideoToCurrentMovie(),a.setRecommendation()})),t.innerHTML=""}),8e3))}})).catch((function(e){console.error(e)}))},a.state={movies:{},currentMovie:{}},a}return Object(v.a)(t,e),Object(u.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.initMovies()}},{key:"initMovies",value:function(){var e=this;y.a.get("".concat(k).concat("discover/movie?language=fr&sort_by=popularity.desc&include_adult=false&append_to_response=images","&").concat(N)).then((function(t){var a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(t.data.results);case 2:a=n.sent,e.setState({movies:a.slice(1,10),currentMovie:a[0]},(function(){e.applyVideoToCurrentMovie()}));case 4:case"end":return n.stop()}}))})).catch((function(e){console.error(e)}))}},{key:"applyVideoToCurrentMovie",value:function(){var e=this;y.a.get("".concat(k,"movie/").concat(this.state.currentMovie.id,"?").concat(N,"&append_to_response=videos&include_adult=false")).then((function(t){var a,n;return o.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,o.a.awrap(t.data.videos.results[0].key);case 2:a=c.sent,(n=e.state.currentMovie).videoId=a,e.setState({currentMovie:n});case 6:case"end":return c.stop()}}))})).catch((function(e){console.error(e)}))}},{key:"onClickListItem",value:function(e){this.setState({currentMovie:e},(function(){this.applyVideoToCurrentMovie(),this.setRecommendation()}))}},{key:"setRecommendation",value:function(){var e=this;y.a.get("".concat(k,"movie/").concat(this.state.currentMovie.id,"/recommendations?").concat(N,"&language=fr")).then((function(t){var a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(t.data.results);case 2:a=n.sent,e.setState({movies:a.slice(0,9)});case 4:case"end":return n.stop()}}))}))}},{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},c.a.createElement("a",{href:"/",className:"navbar-brand"},"Allo ReactMovie"),c.a.createElement("span",{className:"navbar-text ml-auto"},"SPA cod\xe9 avec passion")),c.a.createElement("div",{className:"container mt-5"},c.a.createElement("div",{className:"input-group"},c.a.createElement(f,{callback:this.onClickSearch})),c.a.createElement("p",{id:"error",className:"mt-3"})),c.a.createElement("section",{className:"container-fluid"},c.a.createElement("article",{className:"container_article"},c.a.createElement("div",{className:"container_videoDetails"},c.a.createElement(E,{movie:this.state.currentMovie})),c.a.createElement("div",{className:"embed-responsive embed-responsive-16by9"},c.a.createElement(g,{videoId:this.state.currentMovie.videoId}))),c.a.createElement("aside",{className:"container_aside"},this.state.movies.length>=5?c.a.createElement(p,{movieList:this.state.movies,callback:this.onClickListItem.bind(this)}):c.a.createElement("img",{src:"https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif",alt:"loading gif",width:"80",height:"80"}))))}}]),t}(n.Component);i.a.render(c.a.createElement(M,null),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.49c1d8e5.chunk.js.map